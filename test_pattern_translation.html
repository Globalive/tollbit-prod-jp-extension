<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒ‘ã‚¿ãƒ¼ãƒ³ç¿»è¨³ãƒ†ã‚¹ãƒˆ - TollBitæ‹¡å¼µæ©Ÿèƒ½</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; padding: 20px; background: #f5f5f5; }
    .test-section { background: white; padding: 20px; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .test-case { margin: 10px 0; padding: 10px; border-left: 4px solid #ddd; }
    .test-case.pass { border-color: #4CAF50; background: #f1f8f4; }
    .test-case.fail { border-color: #f44336; background: #fef5f5; }
    .input { color: #1976D2; font-weight: bold; }
    .expected { color: #388E3C; }
    .actual { color: #D32F2F; }
    h1 { color: #333; }
    h2 { color: #666; margin-top: 0; }
    .summary { font-size: 18px; font-weight: bold; padding: 15px; margin: 20px 0; border-radius: 8px; }
    .summary.pass { background: #4CAF50; color: white; }
    .summary.fail { background: #f44336; color: white; }
  </style>
</head>
<body>
  <h1>ğŸ§ª TollBit æ‹¡å¼µæ©Ÿèƒ½ - ãƒ‘ã‚¿ãƒ¼ãƒ³ç¿»è¨³ãƒ†ã‚¹ãƒˆ</h1>
  <div id="results"></div>

  <script>
    // ãƒ‘ã‚¿ãƒ¼ãƒ³ç¿»è¨³å®šç¾©ï¼ˆcontent-cross-frame.jsã‹ã‚‰æŠ½å‡ºï¼‰
    const PATTERN_TRANSLATIONS = [
      {
        "pattern": "Updated (\\d+) days? ago",
        "replacement": "$1æ—¥å‰ã«æ›´æ–°"
      },
      {
        "pattern": "Members \\((\\d+)\\)",
        "replacement": "ãƒ¡ãƒ³ãƒãƒ¼ ($1)"
      },
      {
        "pattern": "AI bots made ([\\d.]+[KMB]) requests to your website, down ([\\d.]+)% from the previous week",
        "replacement": "AIãƒœãƒƒãƒˆãŒã‚ãªãŸã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã«$1ä¸‡ä»¶ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã„ã¾ã—ãŸã€‚å‰é€±æ¯”ã§$2%æ¸›å°‘ã—ã¦ã„ã¾ã™ã€‚"
      },
      {
        "pattern": "You receive more traffic from AI bots than ([\\d.]+)% of other publishers",
        "replacement": "ã‚ãªãŸã¯ä»–ã®ã‚µã‚¤ãƒˆã®$1%ã‚ˆã‚Šå¤šãã€AIãƒœãƒƒãƒˆã‹ã‚‰ã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒã‚ã‚Šã¾ã™ã€‚"
      },
      {
        "pattern": "Top (\\d+) Bots?",
        "replacement": "ä¸Šä½$1ãƒœãƒƒãƒˆ"
      },
      {
        "pattern": "Breakdown the top (\\d+) most active bot agents accessing your content",
        "replacement": "ã‚ãªãŸã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹æœ€ã‚‚æ´»ç™ºãªãƒœãƒƒãƒˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä¸Šä½$1ã®å†…è¨³"
      },
      {
        "pattern": "\\$([\\d.]+)",
        "replacement": "$$$1"
      },
      {
        "pattern": "down ([\\d.]+)%",
        "replacement": "$1ï¼…æ¸›å°‘"
      },
      {
        "pattern": "up ([\\d.]+)%",
        "replacement": "$1ï¼…å¢—åŠ "
      },
      {
        "pattern": "You receive more traffic from this bot than ([\\d.]+)% of other publishers.",
        "replacement": "ã‚ãªãŸã¯ã“ã®ãƒœãƒƒãƒˆã‹ã‚‰ä»–ã®$1%ã®ã‚µã‚¤ãƒˆã‚ˆã‚Šå¤šãã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’å—ã‘å–ã£ã¦ã„ã¾ã™ã€‚"
      },
      {
        "pattern": "only (\\d+)% of websites were scraped more",
        "replacement": "$1ï¼…ã«ä½ç½®ã—ã¦ã„ã¾ã™ã€‚"
      },
      {
        "pattern": "no websites were scraped more",
        "replacement": "ã©ã®ã‚µã‚¤ãƒˆã‚ˆã‚Šã‚‚å¤šãã€ã“ã®AIãƒœãƒƒãƒˆã«ã‚¯ãƒ­ãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã™ã€‚"
      },
      {
        "pattern": "You receive more traffic from this bot than ([\\d.]+)% of other publishers.",
        "replacement": "ã‚ãªãŸã®ã‚µã‚¤ãƒˆã¯ã€ã“ã®ãƒœãƒƒãƒˆã‹ã‚‰ä»–ã®ã‚µã‚¤ãƒˆã®$1ï¼…ã‚ˆã‚Šã‚‚å¤šãã®ãƒœãƒƒãƒˆãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’å—ã‘å–ã£ã¦ã„ã¾ã™ã€‚"
      },
      {
        "pattern": "(\\d+) days? ago",
        "replacement": "$1æ—¥å‰"
      }
    ];

    // ãƒ†ã‚­ã‚¹ãƒˆã‚’æ­£è¦åŒ–ï¼ˆæœ«å°¾ã®å¥èª­ç‚¹ã¨ã‚¹ãƒšãƒ¼ã‚¹ã‚’é™¤å»ï¼‰
    function normalizeText(text) {
      return text.replace(/[.,!?;:\s]+$/, '');
    }

    // ãƒ‘ã‚¿ãƒ¼ãƒ³ç¿»è¨³ã‚’å®Ÿè¡Œ
    function translatePattern(text) {
      const normalized = normalizeText(text);

      for (const patternObj of PATTERN_TRANSLATIONS) {
        try {
          const regex = new RegExp(patternObj.pattern, 'i');
          if (regex.test(normalized)) {
            return normalized.replace(regex, patternObj.replacement);
          }
        } catch (e) {
          console.error(`[ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚¨ãƒ©ãƒ¼] ${patternObj.pattern}:`, e);
          return null;
        }
      }

      return null; // ãƒãƒƒãƒã—ãªã‹ã£ãŸ
    }

    // ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®šç¾©
    const testCases = [
      {
        name: "ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸æ¸›å°‘ (down)",
        input: "down 30.2%",
        expected: "30.2ï¼…æ¸›å°‘"
      },
      {
        name: "ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸å¢—åŠ  (up)",
        input: "up 15.7%",
        expected: "15.7ï¼…å¢—åŠ "
      },
      {
        name: "æ—¥æ•°ï¼ˆå˜æ•°ï¼‰",
        input: "Updated 1 day ago",
        expected: "1æ—¥å‰ã«æ›´æ–°"
      },
      {
        name: "æ—¥æ•°ï¼ˆè¤‡æ•°ï¼‰",
        input: "Updated 55 days ago",
        expected: "55æ—¥å‰ã«æ›´æ–°"
      },
      {
        name: "æ—¥æ•°ã®ã¿ï¼ˆå˜æ•°ï¼‰",
        input: "1 day ago",
        expected: "1æ—¥å‰"
      },
      {
        name: "æ—¥æ•°ã®ã¿ï¼ˆè¤‡æ•°ï¼‰",
        input: "30 days ago",
        expected: "30æ—¥å‰"
      },
      {
        name: "ãƒ¡ãƒ³ãƒãƒ¼æ•°",
        input: "Members (5)",
        expected: "ãƒ¡ãƒ³ãƒãƒ¼ (5)"
      },
      {
        name: "é‡‘é¡",
        input: "$123.45",
        expected: "$123.45"
      },
      {
        name: "Top Botsï¼ˆå˜æ•°ï¼‰",
        input: "Top 1 Bot",
        expected: "ä¸Šä½1ãƒœãƒƒãƒˆ"
      },
      {
        name: "Top Botsï¼ˆè¤‡æ•°ï¼‰",
        input: "Top 5 Bots",
        expected: "ä¸Šä½5ãƒœãƒƒãƒˆ"
      },
      {
        name: "ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«",
        input: "You receive more traffic from AI bots than 95.5% of other publishers",
        expected: "ã‚ãªãŸã¯ä»–ã®ã‚µã‚¤ãƒˆã®95.5%ã‚ˆã‚Šå¤šãã€AIãƒœãƒƒãƒˆã‹ã‚‰ã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒã‚ã‚Šã¾ã™ã€‚"
      },
      {
        name: "è¤‡é›‘ãªãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆAI bots madeï¼‰",
        input: "AI bots made 1.2K requests to your website, down 30.2% from the previous week",
        expected: "AIãƒœãƒƒãƒˆãŒã‚ãªãŸã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã«1.2Kä¸‡ä»¶ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã„ã¾ã—ãŸã€‚å‰é€±æ¯”ã§30.2%æ¸›å°‘ã—ã¦ã„ã¾ã™ã€‚"
      }
    ];

    // ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
    function runTests() {
      const results = [];
      let passCount = 0;
      let failCount = 0;

      testCases.forEach((testCase, index) => {
        const actual = translatePattern(testCase.input);
        const pass = actual === testCase.expected;

        if (pass) {
          passCount++;
        } else {
          failCount++;
        }

        results.push({
          ...testCase,
          actual,
          pass,
          index: index + 1
        });
      });

      return { results, passCount, failCount, total: testCases.length };
    }

    // çµæœã‚’è¡¨ç¤º
    function displayResults() {
      const { results, passCount, failCount, total } = runTests();
      const resultsDiv = document.getElementById('results');

      // ã‚µãƒãƒªãƒ¼
      const summaryClass = failCount === 0 ? 'pass' : 'fail';
      const summaryText = failCount === 0
        ? `âœ… å…¨ãƒ†ã‚¹ãƒˆæˆåŠŸï¼ (${passCount}/${total})`
        : `âŒ ${failCount}å€‹ã®ãƒ†ã‚¹ãƒˆãŒå¤±æ•— (æˆåŠŸ: ${passCount}/${total})`;

      let html = `<div class="summary ${summaryClass}">${summaryText}</div>`;

      // å„ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
      results.forEach(result => {
        const statusIcon = result.pass ? 'âœ…' : 'âŒ';
        const statusClass = result.pass ? 'pass' : 'fail';

        html += `
          <div class="test-section">
            <div class="test-case ${statusClass}">
              <h2>${statusIcon} ãƒ†ã‚¹ãƒˆ #${result.index}: ${result.name}</h2>
              <div><strong>å…¥åŠ›:</strong> <span class="input">"${result.input}"</span></div>
              <div><strong>æœŸå¾…å€¤:</strong> <span class="expected">"${result.expected}"</span></div>
              <div><strong>å®Ÿéš›:</strong> <span class="${result.pass ? 'expected' : 'actual'}">"${result.actual}"</span></div>
              ${!result.pass ? '<div style="color: #D32F2F; font-weight: bold; margin-top: 10px;">âš ï¸ ãƒãƒƒãƒã—ã¾ã›ã‚“ã§ã—ãŸ</div>' : ''}
            </div>
          </div>
        `;
      });

      resultsDiv.innerHTML = html;
    }

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
    displayResults();
  </script>
</body>
</html>
